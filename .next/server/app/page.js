(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8629:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>u,tree:()=>c});var r=a(482),s=a(9108),l=a(2563),n=a.n(l),d=a(8300),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);a.d(t,i);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,751)),"/Users/vedu/Documents/splitwise/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,9205)),"/Users/vedu/Documents/splitwise/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9361,23)),"next/dist/client/components/not-found-error"]}],x=["/Users/vedu/Documents/splitwise/app/page.tsx"],o="/page",m={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8102:(e,t,a)=>{Promise.resolve().then(a.bind(a,5085))},5085:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var r=a(5344),s=a(3729),l=a.n(s),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},d=l().createContext&&l().createContext(n),i=function(){return(i=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},c=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(a[r[s]]=e[r[s]]);return a};function x(e){return function(t){return l().createElement(o,i({attr:i({},e.attr)},t),function e(t){return t&&t.map(function(t,a){return l().createElement(t.tag,i({key:a},t.attr),e(t.child))})}(e.child))}}function o(e){var t=function(t){var a,r=e.attr,s=e.size,n=e.title,d=c(e,["attr","size","title"]),x=s||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),l().createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,d,{className:a,style:i(i({color:e.color||t.color},t.style),e.style),height:x,width:x,xmlns:"http://www.w3.org/2000/svg"}),n&&l().createElement("title",null,n),e.children)};return void 0!==d?l().createElement(d.Consumer,null,function(e){return t(e)}):t(n)}function m(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}}]})(e)}function u(e){return x({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(e)}function h(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"}}]})(e)}function p(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(e)}function g(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(e)}function b(e){return x({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"}}]})(e)}function y(e){return x({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(e)}function j(e){return x({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(e)}var f=a(3044);let v=()=>{let{state:e,setSelectedCurrency:t,toggleDarkMode:a}=(0,f.useDbContext)(),{currencies:s,selectedCurrency:l,darkMode:n}=e;return r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm mb-6 py-4",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-primary dark:text-primary-dark mr-2",children:"Splitwise"}),r.jsx("span",{className:"text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-0.5 rounded",children:"Beta"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("select",{value:l,onChange:e=>t(e.target.value),className:"select-field-sm","aria-label":"Select currency",children:s.map(e=>(0,r.jsxs)("option",{value:e.code,children:[e.code," (",e.symbol,")"]},e.code))}),r.jsx("button",{onClick:a,className:"p-2 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors","aria-label":n?"Switch to light mode":"Switch to dark mode",children:n?r.jsx(b,{}):r.jsx(h,{})})]})]})})},N=()=>{let{addPerson:e,loading:t}=(0,f.useDbContext)(),[a,l]=(0,s.useState)(""),[n,d]=(0,s.useState)(""),[i,c]=(0,s.useState)(!1),[x,o]=(0,s.useState)(null),m=async t=>{if(t.preventDefault(),!a.trim()){o("Name is required");return}try{c(!0),o(null),await e(a.trim()),l(""),d("")}catch(e){console.error("Error adding person:",e),o("Failed to add person. Please try again.")}finally{c(!1)}};return(0,r.jsxs)("div",{className:"card mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Add Person"}),x&&r.jsx("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:x}),(0,r.jsxs)("form",{onSubmit:m,children:[(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),r.jsx("input",{type:"text",id:"name",value:a,onChange:e=>l(e.target.value),className:"input-field",placeholder:"Enter name",disabled:t||i,required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email (Optional)"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:e=>d(e.target.value),className:"input-field",placeholder:"Enter email",disabled:t||i})]}),r.jsx("button",{type:"submit",className:"btn-primary w-full",disabled:t||i,children:i?"Adding...":"Add Person"})]})]})};var k=a(5773),w=a(6026);let C=()=>{let{state:e,removePerson:t,refreshData:a,loading:l}=(0,f.useDbContext)(),{people:n,balances:d,currencies:i,selectedCurrency:c,selectedGroup:x}=e,o=(0,w.h)(),[h,p]=(0,s.useState)(null),[g,b]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[C,S]=(0,s.useState)(!1),[F,P]=(0,s.useState)(null),q=e=>{p(e.id),b(e.name),N(e.email||""),P(null)},E=()=>{p(null),b(""),N(""),P(null)},A=async()=>{if(!g.trim()){P("Name is required");return}try{S(!0),P(null),h&&(await o.people.update(h,g.trim()),await a(),E())}catch(e){console.error("Error updating person:",e),P("Failed to update person. Please try again.")}finally{S(!1)}},D=async e=>{if(window.confirm("Are you sure you want to remove this person? All associated expenses will be deleted."))try{await t(e)}catch(e){console.error("Error removing person:",e),alert("Failed to remove person. Please try again.")}},M=e=>(0,k.xG)(e,c,i),B=e=>e>0?"text-green-600 dark:text-green-400":e<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return(0,r.jsxs)("div",{className:"card mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"People"}),F&&r.jsx("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:F}),0===n.length?r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No people added yet. Add someone to get started."}):r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[r.jsx("th",{className:"text-left py-2 px-2 text-gray-600 dark:text-gray-400 font-medium",children:"Name"}),r.jsx("th",{className:"text-right py-2 px-2 text-gray-600 dark:text-gray-400 font-medium",children:"Balance"}),r.jsx("th",{className:"text-right py-2 px-2 text-gray-600 dark:text-gray-400 font-medium",children:"Actions"})]})}),r.jsx("tbody",{children:n.map(e=>{let t=(0,k.qn)(e.id,x,d);return(0,r.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[r.jsx("td",{className:"py-3 px-2",children:h===e.id?r.jsx("input",{type:"text",value:g,onChange:e=>b(e.target.value),className:"input-field w-full",placeholder:"Enter name",disabled:C}):r.jsx("span",{className:"text-text dark:text-text-dark",children:e.name})}),r.jsx("td",{className:"py-3 px-2 text-right",children:r.jsx("span",{className:B(t),children:M(t)})}),r.jsx("td",{className:"py-3 px-2 text-right",children:h===e.id?(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{onClick:A,className:"p-1 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300",disabled:C,"aria-label":"Save",children:r.jsx(m,{})}),r.jsx("button",{onClick:E,className:"p-1 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",disabled:C,"aria-label":"Cancel",children:r.jsx(y,{})})]}):(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{onClick:()=>q(e),className:"p-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",disabled:l||!!h,"aria-label":`Edit ${e.name}`,children:r.jsx(u,{})}),r.jsx("button",{onClick:()=>D(e.id),className:"p-1 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",disabled:l||!!h,"aria-label":`Remove ${e.name}`,children:r.jsx(j,{})})]})})]},e.id)})})]})})]})},S=()=>{let{state:e,addExpense:t,addCategory:a,loading:l}=(0,f.useDbContext)(),{people:n,categories:d,currencies:i,selectedCurrency:c,selectedGroup:x}=e,[o,m]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[b,y]=(0,s.useState)("food"),[j,v]=(0,s.useState)(c),[N,k]=(0,s.useState)("equal"),[w,C]=(0,s.useState)([]),[S,F]=(0,s.useState)(""),[P,q]=(0,s.useState)(!1),[E,A]=(0,s.useState)(!1),[D,M]=(0,s.useState)(null);(0,s.useEffect)(()=>{v(c)},[c]);let B=()=>{m(""),h(""),g(""),y("food"),v(c),k("equal"),C([]),F(""),q(!1),M(null)},I=async a=>{if(a.preventDefault(),M(null),!o||!u||!p||!b){M("Please fill in all required fields");return}let r=parseFloat(u);if(isNaN(r)||r<=0){M("Please enter a valid amount");return}if("custom"===N){let e=w.reduce((e,t)=>{let a=parseFloat(t.amount);return e+(isNaN(a)?0:a)},0);if(Math.abs(e-r)>.01){M(`The sum of splits (${e.toFixed(2)}) must equal the total amount (${r.toFixed(2)})`);return}}try{A(!0);let a=[];if("equal"===N){let t=x&&"all"!==x?n.filter(t=>e.groups.find(e=>e.id===x)?.members.includes(t.id)):n,s=r/t.length;a=t.map(e=>({personId:e.id,amount:s.toFixed(2)}))}else a=w.map(e=>({personId:e.personId,amount:e.amount}));await t({description:o,amount:r,currency:j,paidById:p,categoryId:b,groupId:"all"===x||null===x?void 0:x,splitAmong:a,date:new Date().toISOString()}),B()}catch(e){console.error("Error adding expense:",e),M("Failed to add expense. Please try again.")}finally{A(!1)}},z=(e,t)=>{C(a=>a.map(a=>a.personId===e?{...a,amount:t}:a))},O=x&&"all"!==x?n.filter(t=>e.groups.find(e=>e.id===x)?.members.includes(t.id)):n;return((0,s.useEffect)(()=>{if("custom"===N&&u&&O.length>0){let e=(parseFloat(u)/O.length).toFixed(2);C(O.map(t=>({personId:t.id,amount:e})))}},[N,u,O]),O.length<2)?r.jsx("div",{className:"mb-6 card",children:r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:x&&"all"!==x&&"no-group"!==x?"Add at least 2 people to this group to create an expense.":"Add at least 2 people to create an expense."})}):(0,r.jsxs)("div",{className:"mb-6 card",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Add Expense"}),(0,r.jsxs)("form",{onSubmit:I,children:[D&&r.jsx("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:D}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),r.jsx("input",{type:"text",id:"description",value:o,onChange:e=>m(e.target.value),className:"input-field",placeholder:"Dinner, Movie tickets, etc.",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount"}),r.jsx("input",{type:"number",id:"amount",value:u,onChange:e=>h(e.target.value),min:"0.01",step:"0.01",className:"input-field",placeholder:"0.00",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Currency"}),r.jsx("select",{id:"currency",value:j,onChange:e=>v(e.target.value),className:"select-field",required:!0,children:i.map(e=>(0,r.jsxs)("option",{value:e.code,children:[e.symbol," ",e.code," - ",e.name]},e.code))})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"paidBy",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Paid by"}),(0,r.jsxs)("select",{id:"paidBy",value:p,onChange:e=>g(e.target.value),className:"select-field",required:!0,children:[r.jsx("option",{value:"",children:"Select a person"}),O.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Split type"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",value:"equal",checked:"equal"===N,onChange:()=>k("equal"),className:"form-radio"}),r.jsx("span",{className:"ml-2 text-text dark:text-text-dark",children:"Equal"})]}),(0,r.jsxs)("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",value:"custom",checked:"custom"===N,onChange:()=>k("custom"),className:"form-radio"}),r.jsx("span",{className:"ml-2 text-text dark:text-text-dark",children:"Custom"})]})]})]}),"custom"===N&&u&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Custom split"}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded",children:w.map(e=>{let t=n.find(t=>t.id===e.personId);return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-text dark:text-text-dark",children:t?.name}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"mr-2 text-gray-500 dark:text-gray-400",children:i.find(e=>e.code===j)?.symbol}),r.jsx("input",{type:"number",value:e.amount,onChange:t=>z(e.personId,t.target.value),min:"0",step:"0.01",className:"w-20 input-field py-1 px-2",required:!0})]})]},e.personId)})})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),r.jsx("div",{className:"flex gap-2",children:(0,r.jsxs)("select",{id:"category",value:b,onChange:e=>y(e.target.value),className:"select-field flex-1",required:!0,children:[r.jsx("option",{value:"",children:"Select a category"}),d.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id)),r.jsx("option",{value:"add-new",children:"+ Add new category"})]})})]}),r.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:l||E,children:E?"Adding...":"Add Expense"})]})]})},F=()=>{let{state:e,removeExpense:t,updateExpense:a,loading:l}=(0,f.useDbContext)(),{expenses:n,people:d,categories:i,currencies:c,selectedCurrency:x,selectedGroup:o}=e,[m,h]=(0,s.useState)(null),[p,b]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[w,C]=(0,s.useState)(""),[S,F]=(0,s.useState)(""),[P,q]=(0,s.useState)(""),[E,A]=(0,s.useState)(!1),[D,M]=(0,s.useState)(null),B=e=>{let t=d.find(t=>t.id===e);return t?t.name:"Unknown"},I=e=>{let t=i.find(t=>t.id===e);return t?t.name:"Other"},z=e=>new Date(e).toLocaleDateString(),O=e=>{h(e.id),b(e.description),N(e.amount.toString()),C(e.paidBy),F(e.categoryId),q(e.currency),M(null)},_=()=>{h(null),M(null)},G=async e=>{if(!p||!v||!w||!S){M("Please fill in all required fields");return}let t=parseFloat(v);if(isNaN(t)||t<=0){M("Please enter a valid amount");return}try{A(!0),await a({...e,description:p,amount:t,paidBy:w,categoryId:S,currency:P}),h(null),M(null)}catch(e){console.error("Error updating expense:",e),M("Failed to update expense. Please try again.")}finally{A(!1)}},L=async e=>{if(window.confirm("Are you sure you want to delete this expense?"))try{await t(e)}catch(e){console.error("Error removing expense:",e),alert("Failed to remove expense. Please try again.")}},H=o&&"all"!==o?n.filter(e=>e.groupId===o):n;return 0===H.length?(0,r.jsxs)("div",{className:"mb-6 card",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Expenses"}),r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No expenses added yet."})]}):(0,r.jsxs)("div",{className:"mb-6 card",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Expenses"}),D&&r.jsx("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:D}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[r.jsx("th",{className:"py-2 text-left text-text dark:text-text-dark",children:"Description"}),r.jsx("th",{className:"py-2 text-left text-text dark:text-text-dark",children:"Amount"}),r.jsx("th",{className:"py-2 text-left text-text dark:text-text-dark",children:"Paid By"}),r.jsx("th",{className:"py-2 text-left text-text dark:text-text-dark",children:"Category"}),r.jsx("th",{className:"py-2 text-left text-text dark:text-text-dark",children:"Date"}),r.jsx("th",{className:"py-2 text-right text-text dark:text-text-dark",children:"Actions"})]})}),r.jsx("tbody",{children:H.map(e=>r.jsx("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:m===e.id?(0,r.jsxs)(r.Fragment,{children:[r.jsx("td",{className:"py-2",children:r.jsx("input",{type:"text",value:p,onChange:e=>b(e.target.value),className:"input-field py-1 px-2 w-full",required:!0})}),r.jsx("td",{className:"py-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("select",{value:P,onChange:e=>q(e.target.value),className:"select-field py-1 px-2 w-24",required:!0,children:c.map(e=>(0,r.jsxs)("option",{value:e.code,children:[e.symbol," ",e.code]},e.code))}),r.jsx("input",{type:"number",value:v,onChange:e=>N(e.target.value),min:"0.01",step:"0.01",className:"input-field py-1 px-2 w-24",required:!0})]})}),r.jsx("td",{className:"py-2",children:r.jsx("select",{value:w,onChange:e=>C(e.target.value),className:"select-field py-1 px-2 w-full",required:!0,children:d.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))})}),r.jsx("td",{className:"py-2",children:r.jsx("select",{value:S,onChange:e=>F(e.target.value),className:"select-field py-1 px-2 w-full",required:!0,children:i.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))})}),r.jsx("td",{className:"py-2",children:z(e.date)}),(0,r.jsxs)("td",{className:"py-2 text-right",children:[r.jsx("button",{onClick:()=>G(e),className:"p-1 text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 mr-2",disabled:E,"aria-label":"Save",children:r.jsx(g,{})}),r.jsx("button",{onClick:_,className:"p-1 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300",disabled:E,"aria-label":"Cancel",children:r.jsx(y,{})})]})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("td",{className:"py-2 text-text dark:text-text-dark",children:e.description}),r.jsx("td",{className:"py-2 text-text dark:text-text-dark",children:(0,k.xG)(e.amount,e.currency,c)}),r.jsx("td",{className:"py-2 text-text dark:text-text-dark",children:B(e.paidBy)}),r.jsx("td",{className:"py-2 text-text dark:text-text-dark",children:I(e.categoryId)}),r.jsx("td",{className:"py-2 text-text dark:text-text-dark",children:z(e.date)}),(0,r.jsxs)("td",{className:"py-2 text-right",children:[r.jsx("button",{onClick:()=>O(e),className:"p-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 mr-2",disabled:l,"aria-label":"Edit",children:r.jsx(u,{})}),r.jsx("button",{onClick:()=>L(e.id),className:"p-1 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",disabled:l,"aria-label":"Delete",children:r.jsx(j,{})})]})]})},e.id))})]})})]})},P=()=>{let{state:e}=(0,f.useDbContext)(),{people:t,balances:a,currencies:s,selectedCurrency:l,selectedGroup:n}=e,d=(()=>{let e=n||"all";if(!a[e])return[];let r=[];for(let s in a[e]){let l=0,n=0;for(let t in a[e][s]){let r=a[e][s][t];r>0?l+=r:r<0&&(n+=Math.abs(r))}let d=l-n;if(Math.abs(d)>.01){let e=t.find(e=>e.id===s);e&&r.push({personId:s,name:e.name,balance:d})}}return r.sort((e,t)=>t.balance-e.balance)})();return 0===d.length?(0,r.jsxs)("div",{className:"mb-6 card",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Balances Summary"}),r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No balances to show."})]}):(0,r.jsxs)("div",{className:"mb-6 card",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Balances Summary"}),r.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:d.map(({personId:e,name:t,balance:a})=>{let n="text-gray-500 dark:text-gray-400",d="is settled up";return a>0?(n="text-green-600 dark:text-green-400",d=`gets back ${(0,k.xG)(a,l,s)}`):a<0&&(n="text-red-600 dark:text-red-400",d=`owes ${(0,k.xG)(Math.abs(a),l,s)}`),(0,r.jsxs)("li",{className:"py-3 flex items-center justify-between",children:[r.jsx("span",{className:"text-text dark:text-text-dark",children:t}),r.jsx("span",{className:n,children:d})]},e)})})]})},q=()=>{let{state:e,addGroup:t,updateGroup:a,removeGroup:l,setSelectedGroup:n,loading:d}=(0,f.useDbContext)(),{groups:i,people:c,selectedGroup:x}=e,[o,m]=(0,s.useState)(!1),[h,g]=(0,s.useState)(null),[b,y]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[k,w]=(0,s.useState)([]),[C,S]=(0,s.useState)(!1),[F,P]=(0,s.useState)(null),q=()=>{y(""),N(""),w([]),m(!1),g(null),P(null)},E=e=>{g(e.id),y(e.name),N(e.description||""),w(e.members||[]),m(!1),P(null)},A=async e=>{if(e.preventDefault(),P(null),!b||0===k.length){P("Please provide a group name and select at least one member");return}try{S(!0),h?await a({id:h,name:b,description:v,members:k}):await t({name:b,description:v,members:k}),q()}catch(e){console.error("Error saving group:",e),P("Failed to save group. Please try again.")}finally{S(!1)}},D=async e=>{if(window.confirm('Are you sure you want to delete this group? Expenses in this group will be moved to "No Group".'))try{await l(e),x===e&&n("all")}catch(e){console.error("Error removing group:",e),alert("Failed to remove group. Please try again.")}},M=e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,r.jsxs)("div",{className:"mb-6 card",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-text dark:text-text-dark",children:"Group"}),(0,r.jsxs)("button",{onClick:()=>{q(),m(!0)},className:"btn-primary-sm flex items-center",disabled:d||C,children:[r.jsx(p,{className:"mr-1"})," New Group"]})]}),F&&r.jsx("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:F}),o||h?(0,r.jsxs)("form",{onSubmit:A,className:"mb-4",children:[(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("label",{htmlFor:"groupName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Group Name"}),r.jsx("input",{type:"text",id:"groupName",value:b,onChange:e=>y(e.target.value),className:"input-field",placeholder:"Trip to Paris, Apartment, etc.",required:!0})]}),(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("label",{htmlFor:"groupDescription",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description (Optional)"}),r.jsx("input",{type:"text",id:"groupDescription",value:v,onChange:e=>N(e.target.value),className:"input-field",placeholder:"A short description of the group"})]}),(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Members"}),r.jsx("div",{className:"max-h-40 overflow-y-auto p-2 border border-gray-200 dark:border-gray-700 rounded",children:0===c.length?r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No people added yet."}):r.jsx("div",{className:"space-y-2",children:c.map(e=>(0,r.jsxs)("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:k.includes(e.id),onChange:()=>M(e.id),className:"mr-2"}),r.jsx("span",{className:"text-text dark:text-text-dark",children:e.name})]},e.id))})})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{type:"submit",className:"btn-primary flex-1",disabled:d||C,children:C?"Saving...":h?"Update Group":"Create Group"}),r.jsx("button",{type:"button",onClick:q,className:"btn-secondary",disabled:C,children:"Cancel"})]})]}):(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("select",{value:x||"all",onChange:e=>n("all"===e.target.value?"all":e.target.value),className:"select-field w-full",children:[r.jsx("option",{value:"all",children:"All Expenses"}),i.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}),x&&"all"!==x&&(0,r.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium text-text dark:text-text-dark",children:i.find(e=>e.id===x)?.name}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.find(e=>e.id===x)?.description||"No description"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>E(i.find(e=>e.id===x)),className:"p-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",disabled:d,"aria-label":"Edit group",children:r.jsx(u,{})}),r.jsx("button",{onClick:()=>D(x),className:"p-1 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",disabled:d,"aria-label":"Delete group",children:r.jsx(j,{})})]})]})]})]})},E=()=>{let{state:e,addSettlement:t,loading:a}=(0,f.useDbContext)(),{people:l,balances:n,currencies:d,selectedCurrency:i,selectedGroup:c}=e,[x,o]=(0,s.useState)(""),[m,u]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[g,b]=(0,s.useState)(i),[y,j]=(0,s.useState)(!1),[v,N]=(0,s.useState)(null),w=async e=>{if(e.preventDefault(),N(null),!x||!m||!h){N("Please fill in all required fields");return}let a=parseFloat(h);if(isNaN(a)||a<=0){N("Please enter a valid amount");return}try{j(!0),await t({fromPersonId:x,toPersonId:m,amount:a,currency:g,groupId:"all"===c||null===c?void 0:c}),o(""),u(""),p(""),b(i)}catch(e){console.error("Error adding settlement:",e),N("Failed to add settlement. Please try again.")}finally{j(!1)}},C=(()=>{let e=c||"all";return l.filter(t=>!!n[e]&&Object.keys(n[e][t.id]||{}).some(a=>n[e][t.id][a]<0))})(),S=(()=>{if(!x)return[];let e=c||"all";return l.filter(t=>t.id!==x&&!!n[e]&&n[e][x][t.id]<0)})(),F=(()=>{if(!x||!m)return 0;let e=c||"all";return n[e]&&n[e][x]&&n[e][x][m]?Math.max(0,-n[e][x][m]):0})();return(0,r.jsxs)("div",{className:"mb-6 card",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Settle Up"}),v&&r.jsx("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:v}),0===C.length?r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No settlements needed."}):(0,r.jsxs)("form",{onSubmit:w,children:[(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"fromPerson",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Who is paying"}),(0,r.jsxs)("select",{id:"fromPerson",value:x,onChange:e=>{o(e.target.value),u(""),p("")},className:"select-field",required:!0,children:[r.jsx("option",{value:"",children:"Select a person"}),C.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),x&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"toPerson",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Who is receiving"}),(0,r.jsxs)("select",{id:"toPerson",value:m,onChange:e=>{u(e.target.value),p("")},className:"select-field",required:!0,children:[r.jsx("option",{value:"",children:"Select a person"}),S.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),x&&m&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Currency"}),r.jsx("select",{id:"currency",value:g,onChange:e=>b(e.target.value),className:"select-field",required:!0,children:d.map(e=>(0,r.jsxs)("option",{value:e.code,children:[e.symbol," ",e.code," - ",e.name]},e.code))})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount"}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("input",{type:"number",id:"amount",value:h,onChange:e=>p(e.target.value),min:"0.01",step:"0.01",max:F.toString(),className:"input-field",required:!0}),r.jsx("button",{type:"button",onClick:()=>p(F.toString()),className:"ml-2 px-2 py-1 text-xs bg-gray-200 dark:bg-gray-700 text-text dark:text-text-dark rounded",children:"Max"})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Maximum amount: ",(0,k.xG)(F,i,d)]})]}),r.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:a||y||!h||0>=parseFloat(h)||parseFloat(h)>F,children:y?"Settling...":"Settle Up"})]})]})]})},A=()=>{let{state:e,loading:t}=(0,f.useDbContext)(),{expenses:a,categories:l,currencies:n,selectedCurrency:d,selectedGroup:i}=e,c=(0,s.useRef)(null),x=["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#8AC249","#EA5F89","#00BFFF","#FFA07A"];(0,s.useEffect)(()=>{if(!c.current||t)return;let e=c.current.getContext("2d");if(!e)return;e.clearRect(0,0,c.current.width,c.current.height);let r=(0,k.NI)(a,i,n,d);if(0===r.length)return;let s=r.reduce((e,t)=>e+t.amount,0);if(s<=0)return;let l=c.current.width/2,o=c.current.height/2,m=Math.min(l,o)-10,u=0;r.forEach((t,a)=>{let r=2*Math.PI*t.amount/s;e.beginPath(),e.moveTo(l,o),e.arc(l,o,m,u,u+r),e.closePath(),e.fillStyle=x[a%x.length],e.fill();let n=u+r/2,d=l+.7*m*Math.cos(n),i=o+.7*m*Math.sin(n);t.amount/s>.05&&(e.fillStyle="#FFFFFF",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(`${Math.round(t.amount/s*100)}%`,d,i)),u+=r})},[a,l,n,d,i,t]);let o=e=>{let t=n.find(e=>e.code===d);return t?new Intl.NumberFormat("en-US",{style:"currency",currency:t.code,currencyDisplay:"symbol"}).format(e):`${e}`},m=e=>{let t=l.find(t=>t.id===e);return t?t.name:"Unknown"},u=a.filter(e=>!i||e.groupId===i).reduce((e,t)=>{let a=n.find(e=>e.code===t.currency)?.exchangeRate||1,r=n.find(e=>e.code===d)?.exchangeRate||1;return e+t.amount/a*r},0),h=(0,k.NI)(a,i,n,d);return(0,r.jsxs)("div",{className:"card mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4 text-text dark:text-text-dark",children:"Category Breakdown"}),t?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."})}):0===a.length?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No expenses added yet."})}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("canvas",{ref:c,width:200,height:200,className:"max-w-full"})}),r.jsx("div",{className:"text-center mb-4",children:(0,r.jsxs)("p",{className:"text-lg font-medium text-text dark:text-text-dark",children:["Total: ",o(u)]})}),r.jsx("div",{className:"space-y-2",children:h.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-4 h-4 mr-2 rounded-sm",style:{backgroundColor:x[t%x.length]}}),r.jsx("span",{className:"text-text dark:text-text-dark",children:m(e.categoryId)})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-text dark:text-text-dark mr-2",children:o(e.amount)}),(0,r.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:["(",Math.round(e.amount/u*100),"%)"]})]})]},e.categoryId))})]})]})};function D(){let{loading:e,error:t}=(0,f.useDbContext)();return e?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Loading..."}),r.jsx("p",{className:"text-gray-500",children:"Please wait while we load your data"})]})}):t?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-semibold mb-2 text-red-600",children:"Error"}),r.jsx("p",{className:"text-gray-500",children:t.message}),r.jsx("button",{className:"mt-4 btn-primary",onClick:()=>window.location.reload(),children:"Retry"})]})}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(v,{}),r.jsx("div",{className:"mb-6",children:r.jsx(q,{})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx(N,{}),r.jsx(C,{}),r.jsx(E,{})]}),(0,r.jsxs)("div",{children:[r.jsx(S,{}),r.jsx(A,{}),r.jsx(F,{})]})]}),r.jsx("div",{className:"mt-6",children:r.jsx(P,{})})]})}},751:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>l,__esModule:()=>s,default:()=>n});let r=(0,a(6843).createProxy)(String.raw`/Users/vedu/Documents/splitwise/app/page.tsx`),{__esModule:s,$$typeof:l}=r,n=r.default}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[886,783],()=>a(8629));module.exports=r})();